<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN""http://www.w3.org/TR/REC-html40/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc on Sun Feb 20 15:42:32 GMT+01:00 2005 -->
<TITLE>
emos_std_err_lib (EMOS Framework API Documentation)
</TITLE>
<META NAME="keywords" CONTENT="std.emos_std_err_lib,emos_std_err_lib script">
<LINK REL ="stylesheet" TYPE="text/css" HREF="../wrdoc.css" TITLE="Style">
</HEAD>
<SCRIPT>
function asd()
{
parent.document.title="emos_std_err_lib (EMOS Framework API Documentation)";
}
</SCRIPT>
<BODY BGCOLOR="white" onload="asd();">

<!-- ========== START OF NAVBAR ========== -->
<A NAME="navbar_top"><!-- --></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0">
<TR>
<TD COLSPAN=3 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Script</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../overview-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<b>FRM </b><br><font size="-1">v1.4.2</font></EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../std/emos_std_attr_lib.html"><B>PREV SCRIPT</B></A>&nbsp;
&nbsp;<A HREF="../std/emos_std_list_lib.html"><B>NEXT SCRIPT</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../index.html" TARGET="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="emos_std_err_lib.html" TARGET="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;
<SCRIPT>
  <!--
  if(window==top) {
    document.writeln('<A HREF="../allclasses-noframe.html" TARGET=""><B>All Scripts</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
<A HREF="../allclasses-noframe.html" TARGET=""><B>All Scripts</B></A>
</NOSCRIPT>
</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">FUNCT</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">FUNCT</A></FONT></TD>
</TR>
</TABLE>
<!-- =========== END OF NAVBAR =========== -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
std</FONT>
<BR>
Script emos_std_err_lib</H2>
<PRE>
CompiledModule
  |
  +--<B>emos_std_err_lib</B>
</PRE>
<HR>

<P>
This library implements an interface to descriptions of WinRunner errors.
 All information about error codes ant the corresponding descriptions are
 maintained in Excel table "default.xls". To keep this library up to date 
 some manual work is necessary. Our approach is two-fold:
 <ul>
	<li>The "official" codes are collected from WinRunner on-line help 
      as this seems to be the only place where Mercury keeps the up-to-date 
		information. This codes are listed in Excel sheet named "documented codes".
	</li>
	<li>The list of additional (undocumented) codes is produced by searching
		the WinRunner "lib" directory and merging the codes that we found into 
		the official list. The merged list is kept in worksheet "all codes".
	</li>
 </ul>
 By default "all codes" are activated. However you may change this by 
 setting the other sheet as default (note that the file is read-only).
 <h4>Language support</h4>
 Note that this library supports two languages so far: English and German.
 We use codes "EN" and "DE" respectively. We have decided to keep our own
 list of language codes (see err_get_supproted_languages()) because we cannot 
 rely on WinRunner's undocumented features such as get_lang() function 
 (which returns "DEU" for German and God knows what for other environments).
 <p>You are welcome to add additional languages. Please inform us about this
 so we can merge your language into our distribution.
 <h4>Typical usage</h4>
 This library is automatically loaded with EMOS Framework. By default english 
 texts are loaded. You would normally change this setting in your startup test, e.g.
 <pre>
	    err_set_language( "DE" );
 </pre>
 To print formatted error descriptions you could do following in your code:
 <pre>
	    rc = set_window( "some non-existing window" );
	    if ( rc != E_OK )
	    {
	    	print( err_perror( rc ) );
	    	tl_step( "Argh!", FAIL, "Have enough for today." );
	    	treturn rc;
	    }
 </pre>
 <h4>Acknowledgements</h4>
 We would especially like to thank Michael Skobowsky from DAT 
 (mailto:Michael.Skobowsky@dat.de) for his German translation and for 
 all his enthusiastic support and ideas.
<P>

<P>
<DL>
<DT><B>Tsl</B></DT>
  <DD><A HREF= "emos_std_err_lib_tsl.html" target=tsl>emos_std_err_lib.tsl</A></DD>
</DL>
<HR>

<P>
<!-- ======== NESTED CLASS SUMMARY ======== -->


<!-- =========== FIELD SUMMARY =========== -->


<!-- ======== CONSTRUCTOR SUMMARY ======== -->


<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Function Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../std/emos_std_err_lib.html#err_get_error_code(mode.in)">err_get_error_code</A></B>(in&nbsp;errNr)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the error code as text for the given error number, e.g. </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../std/emos_std_err_lib.html#err_get_error_desc(mode.in, mode.in)">err_get_error_desc</A></B>(in&nbsp;errNr,
                   in&nbsp;lang)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the error description for the given error number and the langauge code.
 </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../std/emos_std_err_lib.html#err_get_language()">err_get_language</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the code of the default language.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../std/emos_std_err_lib.html#err_get_supproted_languages()">err_get_supproted_languages</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the comma-separated list of the supported languages for
 error descriptions.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../std/emos_std_err_lib.html#err_init()">err_init</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Initialises the internal data structures from external table "default.xls".</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../std/emos_std_err_lib.html#err_is_error(mode.in)">err_is_error</A></B>(in&nbsp;errNr)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns <code>TRUE</code> if given <code>errNr</code> is a known error code.
 </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../std/emos_std_err_lib.html#err_perror(mode.in)">err_perror</A></B>(in&nbsp;errNr)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns formatted error message, e.g. "[-10001] General error occurred. </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../std/emos_std_err_lib.html#err_set_language(mode.in)">err_set_language</A></B>(in&nbsp;lang)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sets the default language to the given <code>lang</code> code.
 </TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->


<!-- ========= CONSTRUCTOR DETAIL ======== -->


<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=1><FONT SIZE="+2">
<B>Function Detail</B></FONT></TD>
</TR>
</TABLE>

<A NAME="err_init()"><!-- --></A><H3>
err_init</H3>
<PRE>
protected String <B>err_init</B>()</PRE>
<DL>
<DD>Initialises the internal data structures from external table "default.xls".
<P>
<DD><DL>

<DT><B>Returns:</B><DD>E_OK if initialisation OK, otherwise failure.</DL>
</DD>
</DL>
<HR>

<A NAME="err_get_supproted_languages()"><!-- --></A><H3>
err_get_supproted_languages</H3>
<PRE>
public String <B>err_get_supproted_languages</B>()</PRE>
<DL>
<DD>Returns the comma-separated list of the supported languages for
 error descriptions.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="err_set_language(mode.in)"><!-- --></A><H3>
err_set_language</H3>
<PRE>
public String <B>err_set_language</B>(in&nbsp;lang)</PRE>
<DL>
<DD>Sets the default language to the given <code>lang</code> code.
 This function returns the code of the new default language.
 If invalid language code is given, no change is made and the old
 default code is returned. The available language codes are returned
 via err_get_supported_languages().
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>lang</CODE> - language code</DL>
</DD>
</DL>
<HR>

<A NAME="err_get_language()"><!-- --></A><H3>
err_get_language</H3>
<PRE>
public String <B>err_get_language</B>()</PRE>
<DL>
<DD>Returns the code of the default language.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="err_is_error(mode.in)"><!-- --></A><H3>
err_is_error</H3>
<PRE>
public String <B>err_is_error</B>(in&nbsp;errNr)</PRE>
<DL>
<DD>Returns <code>TRUE</code> if given <code>errNr</code> is a known error code.
 Otherwise <code>FALSE</code> is returned.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>errNr</CODE> - error number</DL>
</DD>
</DL>
<HR>

<A NAME="err_get_error_desc(mode.in, mode.in)"><!-- --></A><H3>
err_get_error_desc</H3>
<PRE>
public String <B>err_get_error_desc</B>(in&nbsp;errNr,
                                 in&nbsp;lang)</PRE>
<DL>
<DD>Returns the error description for the given error number and the langauge code.
 If no language code was given, the default language is taken.
 For non-existing error numbers an empty string is returned.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>errNr</CODE> - error number</DL>
</DD>
</DL>
<HR>

<A NAME="err_get_error_code(mode.in)"><!-- --></A><H3>
err_get_error_code</H3>
<PRE>
public String <B>err_get_error_code</B>(in&nbsp;errNr)</PRE>
<DL>
<DD>Returns the error code as text for the given error number, e.g. "E_GENERAL_ERROR".
 For non-existing error numbers an empty string is returned.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>errNr</CODE> - error number</DL>
</DD>
</DL>
<HR>

<A NAME="err_perror(mode.in)"><!-- --></A><H3>
err_perror</H3>
<PRE>
public String <B>err_perror</B>(in&nbsp;errNr)</PRE>
<DL>
<DD>Returns formatted error message, e.g. "[-10001] General error occurred. (E_GENERAL_ERROR)".
 The message is also printed out via debug_msg(). 
 <p>NOTE: This function only supports the default language.
<P>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>errNr</CODE> - error number</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>

<!-- ========== START OF NAVBAR ========== -->
<A NAME="navbar_bottom"><!-- --></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0">
<TR>
<TD COLSPAN=3 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Script</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../overview-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<b>FRM </b><br><font size="-1">v1.4.2</font></EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../std/emos_std_attr_lib.html"><B>PREV SCRIPT</B></A>&nbsp;
&nbsp;<A HREF="../std/emos_std_list_lib.html"><B>NEXT SCRIPT</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../index.html" TARGET="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="emos_std_err_lib.html" TARGET="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;
<SCRIPT>
  <!--
  if(window==top) {
    document.writeln('<A HREF="../allclasses-noframe.html" TARGET=""><B>All Scripts</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
<A HREF="../allclasses-noframe.html" TARGET=""><B>All Scripts</B></A>
</NOSCRIPT>
</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">FUNCT</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">FUNCT</A></FONT></TD>
</TR>
</TABLE>
<!-- =========== END OF NAVBAR =========== -->

<HR>

</BODY>
</HTML>
